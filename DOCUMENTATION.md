# Radiology AI Assistant - Comprehensive Documentation

## Table of Contents

1. [Overview](#overview)
2. [System Architecture](#system-architecture)
3. [User Guide](#user-guide)
4. [Administrator Guide](#administrator-guide)
5. [API Reference](#api-reference)
6. [Deployment Guide](#deployment-guide)
7. [Troubleshooting](#troubleshooting)
8. [Security Considerations](#security-considerations)

---

## Overview

### What is Radiology AI Assistant?

The **Radiology AI Assistant** is an AI-powered medical imaging analysis platform that processes DICOM files (X-Ray, CT, and MRI scans) and provides:

- **Automated pathology detection** using deep learning models
- **Clinical recommendations** generated by GPT-4 with RAG (Retrieval-Augmented Generation)
- **Grad-CAM heatmaps** for visual explainability of X-ray findings
- **Role-based access control** for secure multi-user environments

### Supported Modalities

| Modality | DICOM Codes | AI Model | Pathologies Detected |
|----------|-------------|----------|---------------------|
| **X-Ray** | CR, DX | TorchXRayVision DenseNet-121 | 18 chest pathologies |
| **CT Scan** | CT | MONAI DenseNet-121 3D | 6 general findings |
| **MRI** | MR | MONAI DenseNet-121 3D | 6 general findings |

### X-Ray Pathologies Detected

1. Atelectasis
2. Consolidation
3. Infiltration
4. Pneumothorax
5. Edema
6. Emphysema
7. Fibrosis
8. Effusion
9. Pneumonia
10. Pleural Thickening
11. Cardiomegaly
12. Nodule
13. Mass
14. Hernia
15. Lung Lesion
16. Fracture
17. Lung Opacity
18. Enlarged Cardiomediastinum

---

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND (Port 3000)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Login Page  â”‚  â”‚  Dashboard   â”‚  â”‚  Analysis Results Page       â”‚  â”‚
â”‚  â”‚  (index.html)â”‚  â”‚  (dashboard) â”‚  â”‚  (findings + recommendations)â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼ HTTP/REST
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FastAPI BACKEND (Port 8000)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        Authentication Layer                      â”‚   â”‚
â”‚  â”‚  OAuth2 + JWT â”‚ Role-Based Access Control â”‚ Session Management   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         API Endpoints                            â”‚   â”‚
â”‚  â”‚  /api/auth/* â”‚ /api/analyze â”‚ /api/upload â”‚ /api/studies        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      LangGraph WORKFLOW ENGINE                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Relevance  â”‚â”€â”€â”€â–¶â”‚Preprocess  â”‚â”€â”€â”€â–¶â”‚  Vision    â”‚â”€â”€â”€â–¶â”‚    RAG     â”‚  â”‚
â”‚  â”‚  Gateway   â”‚    â”‚   Node     â”‚    â”‚   Model    â”‚    â”‚ Pipeline   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                                                      â”‚         â”‚
â”‚        â–¼                                                      â–¼         â”‚
â”‚  Modality Detection                              Clinical Recommendationsâ”‚
â”‚  (X-Ray vs CT/MRI)                               (GPT-4 + Pinecone)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼               â–¼               â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚TorchXRayVisionâ”‚ â”‚   MONAI    â”‚ â”‚  OpenAI +  â”‚
            â”‚ DenseNet-121 â”‚ â”‚ DenseNet3D â”‚ â”‚  Pinecone  â”‚
            â”‚  (X-Ray)     â”‚ â”‚ (CT/MRI)   â”‚ â”‚   (RAG)    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## User Guide

### Getting Started

#### 1. Accessing the System

1. Open your web browser and navigate to `http://localhost:3000`
2. You will see the login page

#### 2. Creating an Account (Sign Up)

1. Click the **"Sign Up"** tab
2. Fill in the required fields:
   - **Username** (required): Your unique identifier
   - **Password** (required): Secure password
   - **Full Name** (optional): Display name (e.g., "Dr. John Smith")
   - **Email** (optional): Contact email
   - **Role**: Select your role:
     - **Clinical User**: Basic access (upload and view own analyses)
     - **Radiologist**: Extended access (analyze any study, view all studies)
3. Click **"Create Account"**
4. You will be automatically logged in and redirected to the dashboard

#### 3. Signing In

1. Click the **"Sign In"** tab
2. Enter your username and password
3. Click **"Sign In"**

---

### Using the Dashboard

#### Uploading and Analyzing DICOM Files

1. **Drag and Drop Method**:
   - Drag your DICOM file(s) onto the upload zone
   - Analysis begins automatically

2. **Click to Upload Method**:
   - Click the upload zone
   - Select DICOM file(s) from your file browser
   - Analysis begins automatically

3. **Supported File Types**:
   - `.dcm` files (DICOM format)
   - Single or multiple files per study

#### Understanding Analysis Results

After analysis completes, you'll see:

**1. Findings Panel**
```
Finding Name                    Confidence
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Pneumonia                       [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] 78.5%
Lung Opacity                    [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘] 68.7%
Consolidation                   [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘] 63.2%
```

- **Positive Findings**: Pathologies detected above 65% confidence threshold
- **Confidence Bar**: Visual representation of AI certainty
- **Color Coding**:
  - Green (â‰¥70%): High confidence
  - Yellow (50-70%): Medium confidence
  - Gray (<50%): Low confidence

**2. Clinical Recommendations**

AI-generated radiology report including:
- **Examination Type**: Modality identified
- **Findings**: Detailed description of each pathology
- **Impression**: Clinical interpretation
- **Recommendations**: Suggested follow-up actions
- **Urgency Level**: Routine, Semi-urgent, Urgent, or Emergent

**3. Urgency Badges**

| Badge | Meaning | Action Required |
|-------|---------|-----------------|
| ğŸŸ¢ Routine | Normal or minor findings | Standard follow-up |
| ğŸŸ¡ Semi-urgent | Notable findings | Evaluation within 1-2 weeks |
| ğŸŸ  Urgent | Significant findings | Same-day evaluation |
| ğŸ”´ Emergent | Critical findings | Immediate attention |

---

### Role-Based Access

| Feature | Clinical User | Radiologist | Admin |
|---------|--------------|-------------|-------|
| Sign up / Sign in | âœ… | âœ… | âœ… |
| Upload DICOM files | âœ… | âœ… | âœ… |
| Analyze (immediate) | âœ… | âœ… | âœ… |
| View own analyses | âœ… | âœ… | âœ… |
| View all studies | âŒ | âœ… | âœ… |
| Analyze existing studies | âŒ | âœ… | âœ… |
| Delete studies | âŒ | âŒ | âœ… |
| Manage users | âŒ | âŒ | âœ… |

---

## Administrator Guide

### Pre-requisites

Before running the system, ensure you have:

1. **Python 3.10+** installed
2. **Virtual environment** set up
3. **Required packages** installed
4. **API keys** configured

### Initial Setup

#### 1. Environment Setup

```bash
# Create virtual environment
python -m venv venv

# Activate (Windows)
.\venv\Scripts\Activate.ps1

# Activate (Linux/Mac)
source venv/bin/activate

# Install dependencies
pip install -r requirements.txt
```

#### 2. Required Dependencies

```
fastapi
uvicorn
python-multipart
python-jose[cryptography]
passlib
python-dotenv
pydantic
torch
torchvision
torchxrayvision
monai
pydicom
numpy
pillow
openai
pinecone
langgraph
langchain
```

#### 3. Environment Variables

Create a `.env` file in the project root:

```env
# OpenAI API (for RAG recommendations)
OPENAI_API_KEY=sk-your-openai-api-key-here

# Pinecone Vector Database
PINECONE_API_KEY=your-pinecone-api-key-here

# JWT Secret (CHANGE IN PRODUCTION!)
JWT_SECRET_KEY=your-super-secret-key-change-this-in-production
```

### Starting the Services

#### 1. Start the Backend API Server

```bash
cd C:\Users\vince\Desktop\rass
.\venv\Scripts\Activate.ps1
uvicorn radio_assistance.mainapp.process_dicom_endpoint:app --reload --port 8000
```

**Expected output:**
```
INFO:     Uvicorn running on http://127.0.0.1:8000
INFO:     Started reloader process
Loading TorchXRayVision model: densenet121-res224-all
Model loaded successfully. Pathologies: [18 pathologies...]
```

#### 2. Start the Frontend Server

```bash
cd C:\Users\vince\Desktop\rass\frontend
python -m http.server 3000
```

**Expected output:**
```
Serving HTTP on :: port 3000 (http://[::]:3000/)
```

#### 3. Verify Services

| Service | URL | Expected Response |
|---------|-----|-------------------|
| API Health | http://localhost:8000/health | `{"status": "healthy", "version": "1.0.0"}` |
| API Docs | http://localhost:8000/docs | Swagger UI |
| Frontend | http://localhost:3000 | Login page |

### User Management

#### Default Test Accounts

| Username | Password | Role | Permissions |
|----------|----------|------|-------------|
| admin | admin123 | Admin | Full access |
| radiologist | rad123 | Radiologist | Analysis + view all |
| user | user123 | User | Upload + own analyses |

#### Creating Admin Accounts

Admin accounts cannot be created via signup (security measure). To create an admin:

**Option 1: Modify USERS_DB directly** (Development only)

Edit `radio_assistance/mainapp/auth.py`:
```python
USERS_DB = {
    "newadmin": {
        "username": "newadmin",
        "full_name": "New Administrator",
        "email": "newadmin@hospital.org",
        "hashed_password": pwd_context.hash("securepassword"),
        "role": "admin",
        "disabled": False
    },
    # ... existing users
}
```

**Option 2: Database migration** (Production)

In production, implement a proper database with admin CLI:
```bash
python manage.py createadmin --username admin2 --email admin2@hospital.org
```

### Monitoring & Logs

#### API Server Logs

Monitor the uvicorn output for:
- Request logs (endpoints accessed)
- Model loading status
- Error tracebacks
- RAG pipeline operations

#### Log Locations

| Component | Log Location |
|-----------|--------------|
| API Server | Terminal (stdout) |
| Analysis Results | Terminal + API response |
| Upload Files | `./uploads/{study_id}/` |

### Storage Management

#### Upload Directory Structure

```
uploads/
â”œâ”€â”€ {study_id_1}/
â”‚   â”œâ”€â”€ image1.dcm
â”‚   â””â”€â”€ image2.dcm
â”œâ”€â”€ {study_id_2}/
â”‚   â””â”€â”€ scan.dcm
â””â”€â”€ ...
```

#### Cleanup Script

To clean up old studies:

```python
# cleanup_studies.py
from pathlib import Path
from datetime import datetime, timedelta
import shutil

uploads = Path("uploads")
cutoff = datetime.now() - timedelta(days=30)

for study_dir in uploads.iterdir():
    if study_dir.is_dir():
        mtime = datetime.fromtimestamp(study_dir.stat().st_mtime)
        if mtime < cutoff:
            shutil.rmtree(study_dir)
            print(f"Deleted: {study_dir.name}")
```

### RAG Pipeline Configuration

#### Pinecone Index

The system automatically creates a Pinecone index named `xray-recommendations` on first run.

**Index specifications:**
- Dimension: 1536 (text-embedding-3-small)
- Metric: Cosine similarity
- Cloud: AWS us-east-1

#### Knowledge Base

Clinical recommendations are stored in `knowledge_base.py` covering all 18 pathologies with:
- Clinical significance
- Differential diagnoses
- Recommended actions
- Urgency classification
- ICD-10 codes
- Specialty referrals

### Performance Tuning

#### GPU Acceleration

If CUDA is available:
```python
# Automatic GPU detection in tensor_presenter.py
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
```

#### Model Loading

Models are loaded lazily (on first use) and cached:
- TorchXRayVision model: ~500MB, loads in ~5-10 seconds
- MONAI 3D model: ~100MB, loads in ~3-5 seconds

#### Batch Processing

For bulk analysis, use the `/api/upload` endpoint followed by `/api/analyze/{study_id}`:
1. Upload all studies first
2. Queue analysis jobs
3. Retrieve results asynchronously

---

## API Reference

### Authentication Endpoints

#### POST /api/auth/token
**Login and get access token**

```bash
curl -X POST "http://localhost:8000/api/auth/token" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=admin&password=admin123"
```

**Response:**
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIs...",
  "token_type": "bearer",
  "expires_in": 3600
}
```

#### POST /api/auth/signup
**Register new account**

```bash
curl -X POST "http://localhost:8000/api/auth/signup" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "newuser",
    "password": "password123",
    "full_name": "Dr. New User",
    "email": "newuser@hospital.org",
    "role": "radiologist"
  }'
```

#### GET /api/auth/me
**Get current user info**

```bash
curl -X GET "http://localhost:8000/api/auth/me" \
  -H "Authorization: Bearer {token}"
```

### Analysis Endpoints

#### POST /api/analyze
**Upload and analyze DICOM files**

```bash
curl -X POST "http://localhost:8000/api/analyze" \
  -H "Authorization: Bearer {token}" \
  -F "files=@chest_xray.dcm"
```

**Response:**
```json
{
  "study_id": "550e8400-e29b-41d4-a716-446655440000",
  "modality": "CR",
  "findings": [{
    "positive_findings": ["Pneumonia", "Lung Opacity"],
    "top_predictions": [
      ["Lung Opacity", 0.687],
      ["Pneumonia", 0.664],
      ["Consolidation", 0.632]
    ]
  }],
  "recommendations": "EXAMINATION: Chest Radiograph...",
  "urgency": "urgent",
  "status": "completed"
}
```

#### POST /api/upload
**Upload without immediate analysis**

```bash
curl -X POST "http://localhost:8000/api/upload" \
  -H "Authorization: Bearer {token}" \
  -F "files=@scan1.dcm" \
  -F "files=@scan2.dcm"
```

#### POST /api/analyze/{study_id}
**Analyze previously uploaded study**

Requires: Radiologist or Admin role

```bash
curl -X POST "http://localhost:8000/api/analyze/550e8400-e29b-41d4-a716-446655440000" \
  -H "Authorization: Bearer {token}"
```

### Study Management

#### GET /api/studies
**List all studies**

Requires: Radiologist or Admin role

```bash
curl -X GET "http://localhost:8000/api/studies" \
  -H "Authorization: Bearer {token}"
```

#### DELETE /api/study/{study_id}
**Delete a study**

Requires: Admin role

```bash
curl -X DELETE "http://localhost:8000/api/study/550e8400-e29b-41d4-a716-446655440000" \
  -H "Authorization: Bearer {token}"
```

---

## Deployment Guide

### Production Checklist

#### Security

- [ ] Change `JWT_SECRET_KEY` to a strong random value
- [ ] Configure CORS to specific origins (not `*`)
- [ ] Enable HTTPS with valid SSL certificates
- [ ] Set up rate limiting
- [ ] Implement audit logging
- [ ] Configure firewall rules

#### Infrastructure

- [ ] Use a production WSGI server (Gunicorn + Uvicorn workers)
- [ ] Set up load balancer for multiple instances
- [ ] Configure Redis for session caching
- [ ] Use PostgreSQL for user database
- [ ] Set up S3/Azure Blob for DICOM storage
- [ ] Configure backup strategy

#### Monitoring

- [ ] Application performance monitoring (APM)
- [ ] Error tracking (Sentry)
- [ ] Health check endpoints
- [ ] Alerting for service failures

### Docker Deployment

```dockerfile
# Dockerfile
FROM python:3.11-slim

WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

EXPOSE 8000
CMD ["uvicorn", "radio_assistance.mainapp.process_dicom_endpoint:app", "--host", "0.0.0.0", "--port", "8000"]
```

```yaml
# docker-compose.yml
version: '3.8'
services:
  api:
    build: .
    ports:
      - "8000:8000"
    environment:
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      - PINECONE_API_KEY=${PINECONE_API_KEY}
      - JWT_SECRET_KEY=${JWT_SECRET_KEY}
    volumes:
      - uploads:/app/uploads

  frontend:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./frontend:/usr/share/nginx/html

volumes:
  uploads:
```

---

## Troubleshooting

### Common Issues

#### "Failed to fetch" Error

**Cause:** Backend API server not running

**Solution:**
```bash
cd C:\Users\vince\Desktop\rass
.\venv\Scripts\Activate.ps1
uvicorn radio_assistance.mainapp.process_dicom_endpoint:app --reload --port 8000
```

#### "python-multipart" Error

**Cause:** Missing dependency for form handling

**Solution:**
```bash
pip install python-multipart
```

#### "bcrypt" Backend Error

**Cause:** Incompatibility with Python 3.14

**Solution:** Already fixed - using `pbkdf2_sha256` instead of bcrypt

#### Model Loading Slow

**Cause:** First-time model download or CPU-only inference

**Solution:**
- First run downloads ~500MB model (one-time)
- Use GPU if available for faster inference
- Models are cached after first load

#### RAG Pipeline Error

**Cause:** Missing or invalid API keys

**Solution:**
1. Verify `.env` file exists with correct keys
2. Check Pinecone dashboard for index status
3. Verify OpenAI API key is valid

### Error Codes

| HTTP Code | Meaning | Resolution |
|-----------|---------|------------|
| 400 | Bad Request | Check request format |
| 401 | Unauthorized | Login or refresh token |
| 403 | Forbidden | Insufficient role permissions |
| 404 | Not Found | Study ID doesn't exist |
| 500 | Server Error | Check server logs |

---

## Security Considerations

### Authentication

- **JWT Tokens**: 60-minute expiration
- **Password Hashing**: PBKDF2-SHA256
- **Role Enforcement**: Server-side validation

### Data Protection

- **DICOM files**: Stored locally (configure encryption at rest)
- **PHI Handling**: Implement HIPAA compliance measures
- **Access Logs**: Track who accessed what

### API Security

- **CORS**: Configure for specific origins
- **Rate Limiting**: Implement to prevent abuse
- **Input Validation**: Pydantic models enforce types

### Recommendations for Production

1. **Use HTTPS** exclusively
2. **Implement IP whitelisting** for admin functions
3. **Enable audit logging** for all PHI access
4. **Regular security audits**
5. **Data retention policies** for DICOM files
6. **Backup encryption keys** securely

---

## Support

### Getting Help

- **API Documentation**: http://localhost:8000/docs
- **Health Check**: http://localhost:8000/health

### Disclaimer

> **IMPORTANT**: This system is a clinical decision support tool. All AI-generated findings and recommendations must be verified by qualified healthcare professionals. The system does not replace clinical judgment and should not be used as the sole basis for medical decisions.

---

*Documentation Version: 1.0.0*  
*Last Updated: January 2026*



